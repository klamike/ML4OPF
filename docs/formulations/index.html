<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.1">
<title>ml4opf.formulations API documentation</title>
<meta name="description" content="ML4OPF Formulations">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], processEscapes: true } });</script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML" integrity="sha256-kZafAc6mZvK3W3v1pHOcUix30OHQN6pU/NO2oFkqZVw=" crossorigin></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>ml4opf.formulations</code></h1>
</header>
<section id="section-intro">
<h1 id="ml4opf-formulations">ML4OPF Formulations</h1>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="ml4opf.formulations.acp" href="acp/index.html">ml4opf.formulations.acp</a></code></dt>
<dd>
<div class="desc"><p>ACOPF</p></div>
</dd>
<dt><code class="name"><a title="ml4opf.formulations.dcp" href="dcp/index.html">ml4opf.formulations.dcp</a></code></dt>
<dd>
<div class="desc"><p>DCOPF</p></div>
</dd>
<dt><code class="name"><a title="ml4opf.formulations.ed" href="ed/index.html">ml4opf.formulations.ed</a></code></dt>
<dd>
<div class="desc"><p>Economic Dispatch</p></div>
</dd>
<dt><code class="name"><a title="ml4opf.formulations.incidence_mixin" href="incidence_mixin.html">ml4opf.formulations.incidence_mixin</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="ml4opf.formulations.model" href="model.html">ml4opf.formulations.model</a></code></dt>
<dd>
<div class="desc"><p>Abstract base class for ML models for OPF …</p></div>
</dd>
<dt><code class="name"><a title="ml4opf.formulations.problem" href="problem.html">ml4opf.formulations.problem</a></code></dt>
<dd>
<div class="desc"><p>Abstract base class for each OPF problem …</p></div>
</dd>
<dt><code class="name"><a title="ml4opf.formulations.violation" href="violation.html">ml4opf.formulations.violation</a></code></dt>
<dd>
<div class="desc"><p>Abstract base class for OPFViolation classes …</p></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="ml4opf.formulations.ACPModel"><code class="flex name class">
<span>class <span class="ident">ACPModel</span></span>
</code></dt>
<dd>
<div class="desc"><p><code><a title="ml4opf.formulations.OPFModel" href="#ml4opf.formulations.OPFModel">OPFModel</a></code> for ACPPowerModel/ACOPF</p></div>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/0dd79a5b7ba7e1826bd70d110969c0a986455b93/ml4opf/formulations/acp/model.py#L10-L135" class="git-link">Browse git</a></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.model.OPFModel" href="model.html#ml4opf.formulations.model.OPFModel">OPFModel</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.acp.model.PerfectACPModel" href="acp/model.html#ml4opf.formulations.acp.model.PerfectACPModel">PerfectACPModel</a></li>
<li><a title="ml4opf.models.basic_nn.acp_basic_nn.ACPBasicNeuralNet" href="../models/basic_nn/acp_basic_nn.html#ml4opf.models.basic_nn.acp_basic_nn.ACPBasicNeuralNet">ACPBasicNeuralNet</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="ml4opf.formulations.ACPModel.problem"><code class="name">var <span class="ident">problem</span> : <a title="ml4opf.formulations.acp.problem.ACPProblem" href="acp/problem.html#ml4opf.formulations.acp.problem.ACPProblem">ACPProblem</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ml4opf.formulations.ACPModel.violation"><code class="name">var <span class="ident">violation</span> : <a title="ml4opf.formulations.acp.violation.ACPViolation" href="acp/violation.html#ml4opf.formulations.acp.violation.ACPViolation">ACPViolation</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.formulations.ACPModel.evaluate_model"><code class="name flex">
<span>def <span class="ident">evaluate_model</span></span>(<span>self, reduction: Optional[str] = None, inner_reduction: Optional[str] = None) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="desc"><p>Evaluate the model on the test data.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>reduction</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Reduction method for the metrics. Defaults to None. Must be one of "mean", "sum","max", "none".
If specified, each value in the returned dictionary will be a scalar. Otherwise, they are arrays of shape (n_test_samples,)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict[str, Tensor]</code></dt>
<dd>
<p>Dictionary containing Tensor metrics of the model's performance.</p>
<p><code>vm_lower</code>: Lower bound on the voltage magnitude.</p>
<p><code>vm_upper</code>: Upper bound on the voltage magnitude.</p>
<p><code>pg_lower</code>: Lower bound on the real power generation.</p>
<p><code>pg_upper</code>: Upper bound on the real power generation.</p>
<p><code>qg_lower</code>: Lower bound on the reactive power generation.</p>
<p><code>qg_upper</code>: Upper bound on the reactive power generation.</p>
<p><code>thrm_1</code>: Thermal limit violation from</p>
<p><code>thrm_2</code>: Thermal limit violation to</p>
<p><code>p_balance</code>: Active power balance violation.</p>
<p><code>q_balance</code>: Reactive power balance violation.</p>
<p><code>pg_gap</code>: Mean absolute error of the real power generation.</p>
<p><code>qg_gap</code>: Mean absolute error of the reactive power generation.</p>
<p><code>vm_gap</code>: Mean absolute error of the voltage magnitude.</p>
<p><code>va_gap</code>: Mean absolute error of the voltage angle. (if not bus-wise and va not in predictions, skipped)</p>
<p><code>dva_gap</code>: Mean absolute error of the angle difference. (only if not bus-wise)</p>
<p><code>obj_mape</code>: Mean absolute percent error of the objective value.</p>
</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.ACPModel.predict"><code class="name flex">
<span>def <span class="ident">predict</span></span>(<span>self, pd: torch.Tensor, qd: torch.Tensor) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="desc"><p>Predict the ACOPF primal solution for a given set of loads.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power demand per load.</dd>
<dt><strong><code>qd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power demand per load.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict[str, Tensor]</code></dt>
<dd>
<p>Dictionary containing the predicted primal solution.</p>
<p><code>pg</code>: Active power generation per generator or per bus.</p>
<p><code>qg</code>: Reactive power generation per generator or per bus.</p>
<p><code>vm</code>: Voltage magnitude per bus.</p>
<p><code>va</code>: Voltage angle per bus.</p>
</dd>
</dl></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.model.OPFModel" href="model.html#ml4opf.formulations.model.OPFModel">OPFModel</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.model.OPFModel.load_from_checkpoint" href="model.html#ml4opf.formulations.model.OPFModel.load_from_checkpoint">load_from_checkpoint</a></code></li>
<li><code><a title="ml4opf.formulations.model.OPFModel.save_checkpoint" href="model.html#ml4opf.formulations.model.OPFModel.save_checkpoint">save_checkpoint</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="ml4opf.formulations.ACPProblem"><code class="flex name class">
<span>class <span class="ident">ACPProblem</span></span>
<span>(</span><span>data_directory: str, case_name: str, dataset_name: str = 'ACOPF', **parse_kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p><code><a title="ml4opf.formulations.OPFProblem" href="#ml4opf.formulations.OPFProblem">OPFProblem</a></code> for ACPPowerModel/ACOPF</p></div>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/0dd79a5b7ba7e1826bd70d110969c0a986455b93/ml4opf/formulations/acp/problem.py#L9-L78" class="git-link">Browse git</a></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.problem.OPFProblem" href="problem.html#ml4opf.formulations.problem.OPFProblem">OPFProblem</a></li>
<li>abc.ABC</li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="ml4opf.formulations.ACPProblem.default_combos"><code class="name">prop <span class="ident">default_combos</span> : dict[str, list[str]]</code></dt>
<dd>
<div class="desc"><p>Default combos for ACOPF:</p>
<ul>
<li>
<p>input: pd, qd</p>
</li>
<li>
<p>target: pg, qg, vm, va</p>
</li>
</ul></div>
</dd>
<dt id="ml4opf.formulations.ACPProblem.default_order"><code class="name">prop <span class="ident">default_order</span> : list[str]</code></dt>
<dd>
<div class="desc"><p>Default order for ACOPF: input, target</p></div>
</dd>
<dt id="ml4opf.formulations.ACPProblem.feasibility_check"><code class="name">prop <span class="ident">feasibility_check</span> : dict[str, str]</code></dt>
<dd>
<div class="desc"><p>Default feasibility check for ACOPF:</p>
<ul>
<li>
<p>termination_status: "LOCALLY_SOLVED"</p>
</li>
<li>
<p>primal_status: "FEASIBLE_POINT"</p>
</li>
<li>
<p>dual_status: "FEASIBLE_POINT"</p>
</li>
</ul></div>
</dd>
<dt id="ml4opf.formulations.ACPProblem.violation"><code class="name">prop <span class="ident">violation</span> : <a title="ml4opf.formulations.acp.violation.ACPViolation" href="acp/violation.html#ml4opf.formulations.acp.violation.ACPViolation">ACPViolation</a></code></dt>
<dd>
<div class="desc"><p><code><a title="ml4opf.formulations.ACPViolation" href="#ml4opf.formulations.ACPViolation">ACPViolation</a></code> object, created upon first access.</p></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.problem.OPFProblem" href="problem.html#ml4opf.formulations.problem.OPFProblem">OPFProblem</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.problem.OPFProblem.default_parse_only" href="problem.html#ml4opf.formulations.problem.OPFProblem.default_parse_only">default_parse_only</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.make_dataset" href="problem.html#ml4opf.formulations.problem.OPFProblem.make_dataset">make_dataset</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.parse" href="problem.html#ml4opf.formulations.problem.OPFProblem.parse">parse</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.slice_batch" href="problem.html#ml4opf.formulations.problem.OPFProblem.slice_batch">slice_batch</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.slice_tensor" href="problem.html#ml4opf.formulations.problem.OPFProblem.slice_tensor">slice_tensor</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="ml4opf.formulations.ACPViolation"><code class="flex name class">
<span>class <span class="ident">ACPViolation</span></span>
<span>(</span><span>json_data: dict[str, typing.Union[bool, int, float, dict[str, torch.Tensor]]])</span>
</code></dt>
<dd>
<div class="desc"><p><code><a title="ml4opf.formulations.OPFViolation" href="#ml4opf.formulations.OPFViolation">OPFViolation</a></code> for ACPPowerModel/ACOPF</p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p></div>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/0dd79a5b7ba7e1826bd70d110969c0a986455b93/ml4opf/formulations/acp/violation.py#L13-L413" class="git-link">Browse git</a></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.violation.OPFViolation" href="violation.html#ml4opf.formulations.violation.OPFViolation">OPFViolation</a></li>
<li><a title="ml4opf.formulations.incidence_mixin.IncidenceMixin" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin">IncidenceMixin</a></li>
<li>torch.nn.modules.module.Module</li>
<li>abc.ABC</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.formulations.ACPViolation.angle_difference"><code class="name flex">
<span>def <span class="ident">angle_difference</span></span>(<span>self, va: torch.Tensor) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="desc"><p>Compute the angle differences per branch given the voltage angles per bus.</p>
<p><span><span class="MathJax_Preview">
\text{dva} = \boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}
</span><script type="math/tex; mode=display">
\text{dva} = \boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}
</script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>va</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage angles per bus ( <span><span class="MathJax_Preview">\boldsymbol{\theta}</span><script type="math/tex">\boldsymbol{\theta}</script></span> ). (batch_size, nbus)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Angle differences per branch. (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.ACPViolation.balance_residual"><code class="name flex">
<span>def <span class="ident">balance_residual</span></span>(<span>self, pd: torch.Tensor, qd: torch.Tensor, pg: torch.Tensor, qg: torch.Tensor, vm: torch.Tensor, pf: torch.Tensor, pt: torch.Tensor, qf: torch.Tensor, qt: torch.Tensor, clamp: bool = False, embed_method: str = 'pad') ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="desc"><p>Calculate the power balance residual.</p>
<p>Component-wise tensors are first embedded to the bus level using <code>embed_method</code>.</p>
<p>The shunt parameters <span><span class="MathJax_Preview"> g_s, b_s </span><script type="math/tex"> g_s, b_s </script></span> are assumed to be constant, matching the reference case.</p>
<p><span><span class="MathJax_Preview"> \text{p_viol} = \text{pg_bus} - \text{pd_bus} - \text{pt_bus} - \text{pf_bus} - \text{gs_bus} \times \text{vm}^2 </span><script type="math/tex; mode=display"> \text{p_viol} = \text{pg_bus} - \text{pd_bus} - \text{pt_bus} - \text{pf_bus} - \text{gs_bus} \times \text{vm}^2 </script></span>
<span><span class="MathJax_Preview"> \text{q_viol} = \text{qg_bus} - \text{qd_bus} - \text{qt_bus} - \text{qf_bus} + \text{bs_bus} \times \text{vm}^2 </span><script type="math/tex; mode=display"> \text{q_viol} = \text{qg_bus} - \text{qd_bus} - \text{qt_bus} - \text{qf_bus} + \text{bs_bus} \times \text{vm}^2 </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power demand per bus. (batch_size, nbus)</dd>
<dt><strong><code>qd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power demand per bus. (batch_size, nbus)</dd>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power generation per generator. (batch_size, ngen)</dd>
<dt><strong><code>qg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power generation per generator. (batch_size, ngen)</dd>
<dt><strong><code>vm</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage magnitude per bus. (batch_size, nbus)</dd>
<dt><strong><code>pf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power flow from bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>pt</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power flow to bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>qf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power flow from bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>qt</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power flow to bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Apply an absolute value to the residual. Defaults to False.</dd>
<dt><strong><code>embed_method</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Embedding method for bus-level components. Defaults to 'pad'. Must be one of 'pad', 'dense_matrix', or 'matrix. See <code>IncidenceMixin.*_to_bus</code>.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Power balance residual for active power. (batch_size, nbus)</dd>
<dt><code>Tensor</code></dt>
<dd>Power balance residual for reactive power. (batch_size, nbus)</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.ACPViolation.calc_violations"><code class="name flex">
<span>def <span class="ident">calc_violations</span></span>(<span>self, pd: torch.Tensor, qd: torch.Tensor, pg: torch.Tensor, qg: torch.Tensor, vm: torch.Tensor, va: Optional[torch.Tensor] = None, dva: Optional[torch.Tensor] = None, flows: Optional[tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor]] = None, reduction: Optional[str] = 'mean', clamp: bool = True) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="desc"><p>Calculate the violation of all the constraints.</p>
<p>The reduction is applied across the component dimension - e.g., 'mean' will do violation.mean(dim=1) where each violation is (batch, components)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Real power demand. (batch, loads)</dd>
<dt><strong><code>qd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power demand. (batch, loads)</dd>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Real power generation. (batch, gens)</dd>
<dt><strong><code>qg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power generation. (batch, gens)</dd>
<dt><strong><code>vm</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage magnitude. (batch, buses)</dd>
<dt><strong><code>va</code></strong> :&ensp;<code>Tensor</code>, optional</dt>
<dd>Voltage angle. (batch, buses)</dd>
<dt><strong><code>dva</code></strong> :&ensp;<code>Tensor</code>, optional</dt>
<dd>Voltage angle difference. (batch, branches)</dd>
<dt><strong><code>flows</code></strong> :&ensp;<code>tuple[Tensor, Tensor, Tensor, Tensor]</code>, optional</dt>
<dd>Power flows. (pf, pt, qf, qt)</dd>
<dt><strong><code>reduction</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Reduction method. Defaults to 'mean'. Must be one of 'mean', 'sum', 'none'.</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to True.</dd>
</dl>
<h2 id="returns">Returns</h2>
<ul>
<li>dict[str, Tensor]: Dictionary of violations.</li>
</ul>
<p><code>vm_lower</code>: Voltage magnitude lower bound violation.</p>
<p><code>vm_upper</code>: Voltage magnitude upper bound violation.</p>
<p><code>pg_lower</code>: Real power generation lower bound violation.</p>
<p><code>pg_upper</code>: Real power generation upper bound violation.</p>
<p><code>qg_lower</code>: Reactive power generation lower bound violation.</p>
<p><code>qg_upper</code>: Reactive power generation upper bound violation.</p>
<p><code>thrm_1</code>: Thermal limit from violation.</p>
<p><code>thrm_2</code>: Thermal limit to violation.</p>
<p><code>p_balance</code>: Real power balance violation.</p>
<p><code>q_balance</code>: Reactive power balance violation.</p>
<p><code>dva_lower</code>: Voltage angle difference lower bound violation.</p>
<p><code>dva_upper</code>: Voltage angle difference upper bound violation.</p></div>
</dd>
<dt id="ml4opf.formulations.ACPViolation.dva_bound_residual"><code class="name flex">
<span>def <span class="ident">dva_bound_residual</span></span>(<span>self, dva: torch.Tensor, clamp: bool = False) ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="desc"><p>Calculate the voltage angle difference bound residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{lower}} = \text{angmin} - \text{dva} </span><script type="math/tex; mode=display"> g_{\text{lower}} = \text{angmin} - \text{dva} </script></span>
<span><span class="MathJax_Preview"> g_{\text{upper}} = \text{dva} - \text{angmax} </span><script type="math/tex; mode=display"> g_{\text{upper}} = \text{dva} - \text{angmax} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>dva</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage angle difference per branch. (batch_size, nbranch)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.ACPViolation.flows_from_voltage"><code class="name flex">
<span>def <span class="ident">flows_from_voltage</span></span>(<span>self, vm: torch.Tensor, dva: torch.Tensor) ‑> tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="desc"><p>Compute the power flows given the voltage magnitude per bus and angle differences per branch.</p>
<p>The branch (transformer + line) parameters <span><span class="MathJax_Preview"> g, b, g_f, b_f, g_t, b_t, t_r, t_i </span><script type="math/tex"> g, b, g_f, b_f, g_t, b_t, t_r, t_i </script></span> and <span><span class="MathJax_Preview"> \text{tap} </span><script type="math/tex"> \text{tap} </script></span>
are assumed to be constant <em>for the life of this object</em>, matching the reference case.
These constants are pre-computed using the <code>MOFACP._compute_flow_constants</code> function.</p>
<p><span><span class="MathJax_Preview"> \mathbf{p}_f = \frac{g + g_{f}}{\text{tap}^2} \mathbf{v}_{f}^2 + \frac{-g t_r + b t_i}{\text{tap}^2} \mathbf{v}_{f} \mathbf{v}_{t} \cos(\boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}) + \frac{-b t_r - g t_i}{\text{tap}^2} \mathbf{v}_{f} \mathbf{v}_{t} \sin(\boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}) </span><script type="math/tex; mode=display"> \mathbf{p}_f = \frac{g + g_{f}}{\text{tap}^2} \mathbf{v}_{f}^2 + \frac{-g t_r + b t_i}{\text{tap}^2} \mathbf{v}_{f} \mathbf{v}_{t} \cos(\boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}) + \frac{-b t_r - g t_i}{\text{tap}^2} \mathbf{v}_{f} \mathbf{v}_{t} \sin(\boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}) </script></span>
<span><span class="MathJax_Preview"> \mathbf{p}_t = (g + g_{t}) \mathbf{v}_{t}^2 + \frac{-g t_r - b t_i}{\text{tap}^2} \mathbf{v}_{f} \mathbf{v}_{t} \cos(\boldsymbol{\theta}_{t} - \boldsymbol{\theta}_{f}) + \frac{-b t_r + g t_i}{\text{tap}^2} \mathbf{v}_{f} \mathbf{v}_{t} \sin(\boldsymbol{\theta}_{t} - \boldsymbol{\theta}_{f}) </span><script type="math/tex; mode=display"> \mathbf{p}_t = (g + g_{t}) \mathbf{v}_{t}^2 + \frac{-g t_r - b t_i}{\text{tap}^2} \mathbf{v}_{f} \mathbf{v}_{t} \cos(\boldsymbol{\theta}_{t} - \boldsymbol{\theta}_{f}) + \frac{-b t_r + g t_i}{\text{tap}^2} \mathbf{v}_{f} \mathbf{v}_{t} \sin(\boldsymbol{\theta}_{t} - \boldsymbol{\theta}_{f}) </script></span>
<span><span class="MathJax_Preview"> \mathbf{q}_f = \frac{-(b + b_{f})}{\text{tap}^2} \mathbf{v}_{f}^2 - \frac{-b t_r - g t_i}{\text{tap}^2} \mathbf{v}_{f} \mathbf{v}_{t} \cos(\boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}) + \frac{-g t_r + b t_i}{\text{tap}^2} \mathbf{v}_{f} \mathbf{v}_{t} \sin(\boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}) </span><script type="math/tex; mode=display"> \mathbf{q}_f = \frac{-(b + b_{f})}{\text{tap}^2} \mathbf{v}_{f}^2 - \frac{-b t_r - g t_i}{\text{tap}^2} \mathbf{v}_{f} \mathbf{v}_{t} \cos(\boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}) + \frac{-g t_r + b t_i}{\text{tap}^2} \mathbf{v}_{f} \mathbf{v}_{t} \sin(\boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}) </script></span>
<span><span class="MathJax_Preview"> \mathbf{q}_t = -(b + b_{t}) \mathbf{v}_{t}^2 - \frac{-b t_r + g t_i}{\text{tap}^2} \mathbf{v}_{f} \mathbf{v}_{t} \cos(\boldsymbol{\theta}_{t} - \boldsymbol{\theta}_{f}) + \frac{-g t_r - b t_i}{\text{tap}^2} \mathbf{v}_{f} \mathbf{v}_{t} \sin(\boldsymbol{\theta}_{t} - \boldsymbol{\theta}_{f}) </span><script type="math/tex; mode=display"> \mathbf{q}_t = -(b + b_{t}) \mathbf{v}_{t}^2 - \frac{-b t_r + g t_i}{\text{tap}^2} \mathbf{v}_{f} \mathbf{v}_{t} \cos(\boldsymbol{\theta}_{t} - \boldsymbol{\theta}_{f}) + \frac{-g t_r - b t_i}{\text{tap}^2} \mathbf{v}_{f} \mathbf{v}_{t} \sin(\boldsymbol{\theta}_{t} - \boldsymbol{\theta}_{f}) </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>vm</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage magnitude per bus ( <span><span class="MathJax_Preview">\mathbf{v}</span><script type="math/tex">\mathbf{v}</script></span> ). (batch_size, nbus)</dd>
<dt><strong><code>dva</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Angle differences per branch ( <span><span class="MathJax_Preview"> \boldsymbol{\theta}_f - \boldsymbol{\theta}_t </span><script type="math/tex"> \boldsymbol{\theta}_f - \boldsymbol{\theta}_t </script></span> ). (batch_size, nbranch)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Real power flow per branch ( <span><span class="MathJax_Preview">\mathbf{p}_f</span><script type="math/tex">\mathbf{p}_f</script></span> ). (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Real power flow per branch ( <span><span class="MathJax_Preview">\mathbf{p}_t</span><script type="math/tex">\mathbf{p}_t</script></span> ). (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Reactive power flow per branch ( <span><span class="MathJax_Preview">\mathbf{q}_f</span><script type="math/tex">\mathbf{q}_f</script></span> ). (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Reactive power flow per branch ( <span><span class="MathJax_Preview">\mathbf{q}_t</span><script type="math/tex">\mathbf{q}_t</script></span> ). (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.ACPViolation.flows_from_voltage_bus"><code class="name flex">
<span>def <span class="ident">flows_from_voltage_bus</span></span>(<span>self, vm: torch.Tensor, va: torch.Tensor) ‑> tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="desc"><p>Compute the power flows given the voltage magnitude per bus and voltage angles per bus.</p>
<p>This function computes angle differences then calls <code><a title="ml4opf.formulations.ACPViolation.flows_from_voltage" href="#ml4opf.formulations.ACPViolation.flows_from_voltage">ACPViolation.flows_from_voltage()</a></code>.
See the docstring of <code><a title="ml4opf.formulations.ACPViolation.flows_from_voltage" href="#ml4opf.formulations.ACPViolation.flows_from_voltage">ACPViolation.flows_from_voltage()</a></code> for more details.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>vm</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage magnitude per bus ( <span><span class="MathJax_Preview">\mathbf{v}</span><script type="math/tex">\mathbf{v}</script></span> ). (batch_size, nbus)</dd>
<dt><strong><code>va</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage angle per bus ( <span><span class="MathJax_Preview">\boldsymbol{\theta}</span><script type="math/tex">\boldsymbol{\theta}</script></span> ). (batch_size, nbus)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Real power flow per branch ( <span><span class="MathJax_Preview">\mathbf{p}_f</span><script type="math/tex">\mathbf{p}_f</script></span> ). (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Real power flow per branch ( <span><span class="MathJax_Preview">\mathbf{p}_t</span><script type="math/tex">\mathbf{p}_t</script></span> ). (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Reactive power flow per branch ( <span><span class="MathJax_Preview">\mathbf{q}_f</span><script type="math/tex">\mathbf{q}_f</script></span> ). (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Reactive power flow per branch ( <span><span class="MathJax_Preview">\mathbf{q}_t</span><script type="math/tex">\mathbf{q}_t</script></span> ). (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.ACPViolation.objective"><code class="name flex">
<span>def <span class="ident">objective</span></span>(<span>self, pg: torch.Tensor) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="desc"><p>Compute the objective function given the active power generation per generator.</p>
<p><span><span class="MathJax_Preview">
\text{objective} = \sum_{i=1}^{n} \text{cost}_{2,i} + \text{cost}_{1,i} \cdot \text{pg}_i
</span><script type="math/tex; mode=display">
\text{objective} = \sum_{i=1}^{n} \text{cost}_{2,i} + \text{cost}_{1,i} \cdot \text{pg}_i
</script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power generation per generator. (batch_size, ngen)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Objective function value. (batch_size)</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.ACPViolation.pg_bound_residual"><code class="name flex">
<span>def <span class="ident">pg_bound_residual</span></span>(<span>self, pg: torch.Tensor, clamp: bool = False) ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="desc"><p>Calculate the active power generation bound residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{lower}} = \text{pmin} - \text{pg} </span><script type="math/tex; mode=display"> g_{\text{lower}} = \text{pmin} - \text{pg} </script></span>
<span><span class="MathJax_Preview"> g_{\text{upper}} = \text{pg} - \text{pmax} </span><script type="math/tex; mode=display"> g_{\text{upper}} = \text{pg} - \text{pmax} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power generation per generator. (batch_size, ngen)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, ngen)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, ngen)</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.ACPViolation.qg_bound_residual"><code class="name flex">
<span>def <span class="ident">qg_bound_residual</span></span>(<span>self, qg: torch.Tensor, clamp: bool = False) ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="desc"><p>Calculate the reactive power generation bound residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{lower}} = \text{qmin} - \text{qg} </span><script type="math/tex; mode=display"> g_{\text{lower}} = \text{qmin} - \text{qg} </script></span>
<span><span class="MathJax_Preview"> g_{\text{upper}} = \text{qg} - \text{qmax} </span><script type="math/tex; mode=display"> g_{\text{upper}} = \text{qg} - \text{qmax} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>qg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power generation per generator. (batch_size, ngen)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, ngen)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, ngen)</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.ACPViolation.thermal_residual"><code class="name flex">
<span>def <span class="ident">thermal_residual</span></span>(<span>self, pf: torch.Tensor, pt: torch.Tensor, qf: torch.Tensor, qt: torch.Tensor, clamp: bool = False) ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="desc"><p>Calculate the thermal limit residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{thrm}_1} = \text{pf}^2 + \text{qf}^2 - \text{s1max} </span><script type="math/tex; mode=display"> g_{\text{thrm}_1} = \text{pf}^2 + \text{qf}^2 - \text{s1max} </script></span>
<span><span class="MathJax_Preview"> g_{\text{thrm}_2} = \text{pt}^2 + \text{qt}^2 - \text{s2max} </span><script type="math/tex; mode=display"> g_{\text{thrm}_2} = \text{pt}^2 + \text{qt}^2 - \text{s2max} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power flow from bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>pt</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power flow to bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>qf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power flow from bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>qt</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power flow to bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Thermal limit residual for from branch. (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Thermal limit residual for to branch. (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.ACPViolation.vm_bound_residual"><code class="name flex">
<span>def <span class="ident">vm_bound_residual</span></span>(<span>self, vm: torch.Tensor, clamp: bool = False) ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="desc"><p>Calculate the voltage magnitude bound residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{lower}} = \text{vmin} - \text{vm} </span><script type="math/tex; mode=display"> g_{\text{lower}} = \text{vmin} - \text{vm} </script></span>
<span><span class="MathJax_Preview"> g_{\text{upper}} = \text{vm} - \text{vmax} </span><script type="math/tex; mode=display"> g_{\text{upper}} = \text{vm} - \text{vmax} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>vm</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage magnitude per bus. (batch_size, nbus)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, nbus)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, nbus)</dd>
</dl></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.violation.OPFViolation" href="violation.html#ml4opf.formulations.violation.OPFViolation">OPFViolation</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.violation.OPFViolation.adjacency_matrix" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.adjacency_matrix">adjacency_matrix</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_from_incidence" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_from_incidence">branch_from_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_from_to_bus" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_from_to_bus">branch_from_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_incidence" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_incidence">branch_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_to_incidence" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_to_incidence">branch_to_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_to_to_bus" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_to_to_bus">branch_to_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.forward" href="violation.html#ml4opf.formulations.violation.OPFViolation.forward">forward</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.gen_to_bus" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.gen_to_bus">gen_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.generator_incidence" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.generator_incidence">generator_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.load_incidence" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.load_incidence">load_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.load_to_bus" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.load_to_bus">load_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.violation_shapes" href="violation.html#ml4opf.formulations.violation.OPFViolation.violation_shapes">violation_shapes</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="ml4opf.formulations.DCPModel"><code class="flex name class">
<span>class <span class="ident">DCPModel</span></span>
</code></dt>
<dd>
<div class="desc"><p><code><a title="ml4opf.formulations.OPFModel" href="#ml4opf.formulations.OPFModel">OPFModel</a></code> for DCPPowerModel/DCOPF</p></div>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/0dd79a5b7ba7e1826bd70d110969c0a986455b93/ml4opf/formulations/dcp/model.py#L11-L92" class="git-link">Browse git</a></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.model.OPFModel" href="model.html#ml4opf.formulations.model.OPFModel">OPFModel</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.dcp.model.PerfectDCPModel" href="dcp/model.html#ml4opf.formulations.dcp.model.PerfectDCPModel">PerfectDCPModel</a></li>
<li><a title="ml4opf.models.basic_nn.dcp_basic_nn.DCPBasicNeuralNet" href="../models/basic_nn/dcp_basic_nn.html#ml4opf.models.basic_nn.dcp_basic_nn.DCPBasicNeuralNet">DCPBasicNeuralNet</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="ml4opf.formulations.DCPModel.problem"><code class="name">var <span class="ident">problem</span> : <a title="ml4opf.formulations.dcp.problem.DCPProblem" href="dcp/problem.html#ml4opf.formulations.dcp.problem.DCPProblem">DCPProblem</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ml4opf.formulations.DCPModel.violation"><code class="name">var <span class="ident">violation</span> : <a title="ml4opf.formulations.dcp.violation.DCPViolation" href="dcp/violation.html#ml4opf.formulations.dcp.violation.DCPViolation">DCPViolation</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.formulations.DCPModel.evaluate_model"><code class="name flex">
<span>def <span class="ident">evaluate_model</span></span>(<span>self, reduction: Optional[str] = None, inner_reduction: Optional[str] = None) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="desc"><p>Evaluate the model on the test data.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>reduction</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Reduction method for the metrics. Defaults to None. Must be one of "mean", "sum","max", "none".
If specified, each value in the returned dictionary will be a scalar. Otherwise, they are arrays of shape (n_test_samples,)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict[str, Tensor]</code></dt>
<dd>
<p>Dictionary containing Tensor metrics of the model's performance.</p>
<p><code>pg_lower</code>: Generator lower bound violation.</p>
<p><code>pg_upper</code>: Generator upper bound violation.</p>
<p><code>dva_lower</code>: Angle difference limit lower bound violation.</p>
<p><code>dva_upper</code>: Angle difference limit upper bound violation.</p>
<p><code>pf_lower</code>: Flow limit lower bound violation.</p>
<p><code>pf_upper</code>: Flow limit upper bound violation.</p>
<p><code>p_balance</code>: Power balance violation.</p>
<p><code>pg_gap</code>: Mean absolute error of the real power generation.</p>
<p><code>va_gap</code>: Mean absolute error of the voltage angle. (if not bus-wise and va not in predictions, skipped)</p>
<p><code>pf_gap</code>: Mean absolute error of the real power flow.</p>
<p><code>obj_mape</code>: Mean absolute percent error of the objective value.</p>
</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.DCPModel.predict"><code class="name flex">
<span>def <span class="ident">predict</span></span>(<span>self, pd: torch.Tensor) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="desc"><p>Predict the DCOPF primal solution for a given set of loads.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power demand per load.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict[str, Tensor]</code></dt>
<dd>
<p>Dictionary containing the predicted primal solution.</p>
<p><code>pg</code>: Active power generation per generator or per bus.</p>
<p><code>va</code>: Voltage angle per bus.</p>
</dd>
</dl></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.model.OPFModel" href="model.html#ml4opf.formulations.model.OPFModel">OPFModel</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.model.OPFModel.load_from_checkpoint" href="model.html#ml4opf.formulations.model.OPFModel.load_from_checkpoint">load_from_checkpoint</a></code></li>
<li><code><a title="ml4opf.formulations.model.OPFModel.save_checkpoint" href="model.html#ml4opf.formulations.model.OPFModel.save_checkpoint">save_checkpoint</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="ml4opf.formulations.DCPProblem"><code class="flex name class">
<span>class <span class="ident">DCPProblem</span></span>
<span>(</span><span>data_directory: str, case_name: str, dataset_name: str = 'DCOPF', **parse_kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p><code><a title="ml4opf.formulations.OPFProblem" href="#ml4opf.formulations.OPFProblem">OPFProblem</a></code> for DCPPowerModel/DCOPF</p></div>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/0dd79a5b7ba7e1826bd70d110969c0a986455b93/ml4opf/formulations/dcp/problem.py#L5-L64" class="git-link">Browse git</a></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.problem.OPFProblem" href="problem.html#ml4opf.formulations.problem.OPFProblem">OPFProblem</a></li>
<li>abc.ABC</li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="ml4opf.formulations.DCPProblem.default_combos"><code class="name">prop <span class="ident">default_combos</span> : dict[str, list[str]]</code></dt>
<dd>
<div class="desc"><p>Default combos for DCOPF:</p>
<ul>
<li>
<p>input: pd</p>
</li>
<li>
<p>target: pg, va</p>
</li>
</ul></div>
</dd>
<dt id="ml4opf.formulations.DCPProblem.default_order"><code class="name">prop <span class="ident">default_order</span> : list[str]</code></dt>
<dd>
<div class="desc"><p>Default order for DCOPF. input, target</p></div>
</dd>
<dt id="ml4opf.formulations.DCPProblem.feasibility_check"><code class="name">prop <span class="ident">feasibility_check</span> : dict[str, str]</code></dt>
<dd>
<div class="desc"><p>Default feasibility check for DCOPF:</p>
<ul>
<li>
<p>termination_status: "OPTIMAL"</p>
</li>
<li>
<p>primal_status: "FEASIBLE_POINT"</p>
</li>
<li>
<p>dual_status: "FEASIBLE_POINT"</p>
</li>
</ul></div>
</dd>
<dt id="ml4opf.formulations.DCPProblem.violation"><code class="name">prop <span class="ident">violation</span> : <a title="ml4opf.formulations.dcp.violation.DCPViolation" href="dcp/violation.html#ml4opf.formulations.dcp.violation.DCPViolation">DCPViolation</a></code></dt>
<dd>
<div class="desc"><p>OPFViolation object for DCOPF constraint calculations.</p></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.problem.OPFProblem" href="problem.html#ml4opf.formulations.problem.OPFProblem">OPFProblem</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.problem.OPFProblem.default_parse_only" href="problem.html#ml4opf.formulations.problem.OPFProblem.default_parse_only">default_parse_only</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.make_dataset" href="problem.html#ml4opf.formulations.problem.OPFProblem.make_dataset">make_dataset</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.parse" href="problem.html#ml4opf.formulations.problem.OPFProblem.parse">parse</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.slice_batch" href="problem.html#ml4opf.formulations.problem.OPFProblem.slice_batch">slice_batch</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.slice_tensor" href="problem.html#ml4opf.formulations.problem.OPFProblem.slice_tensor">slice_tensor</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="ml4opf.formulations.DCPViolation"><code class="flex name class">
<span>class <span class="ident">DCPViolation</span></span>
<span>(</span><span>json_data: dict[str, typing.Union[bool, int, float, dict[str, torch.Tensor]]])</span>
</code></dt>
<dd>
<div class="desc"><p><code><a title="ml4opf.formulations.OPFViolation" href="#ml4opf.formulations.OPFViolation">OPFViolation</a></code> for DCPPowerModel/DCOPF</p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p></div>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/0dd79a5b7ba7e1826bd70d110969c0a986455b93/ml4opf/formulations/dcp/violation.py#L13-L271" class="git-link">Browse git</a></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.violation.OPFViolation" href="violation.html#ml4opf.formulations.violation.OPFViolation">OPFViolation</a></li>
<li><a title="ml4opf.formulations.incidence_mixin.IncidenceMixin" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin">IncidenceMixin</a></li>
<li>torch.nn.modules.module.Module</li>
<li>abc.ABC</li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="ml4opf.formulations.DCPViolation.nrate_a"><code class="name">prop <span class="ident">nrate_a</span> : torch.Tensor</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.formulations.DCPViolation.angle_difference"><code class="name flex">
<span>def <span class="ident">angle_difference</span></span>(<span>self, va: torch.Tensor) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="desc"><p>Compute the angle differences per branch given the voltage angles per bus.</p>
<p>The branch indices are assumed to be constant for the batch, matching the reference case.</p>
<p><span><span class="MathJax_Preview">
\text{dva} = \boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}
</span><script type="math/tex; mode=display">
\text{dva} = \boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}
</script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>va</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage angles per bus ( <span><span class="MathJax_Preview">\boldsymbol{\theta}</span><script type="math/tex">\boldsymbol{\theta}</script></span> ). (batch_size, nbus)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Angle differences per branch. (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.DCPViolation.balance_residual"><code class="name flex">
<span>def <span class="ident">balance_residual</span></span>(<span>self, pd: torch.Tensor, pg: torch.Tensor, pf: torch.Tensor, embed_method: str = 'pad', clamp: bool = True) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="desc"><p>Compute power balance residual.</p>
<p><span><span class="MathJax_Preview">
\text{g_balance} = \text{pg_bus} - \text{pd_bus} - \text{gs_bus} - \text{pf_bus} - \text{pt_bus}
</span><script type="math/tex; mode=display">
\text{g_balance} = \text{pg_bus} - \text{pd_bus} - \text{gs_bus} - \text{pf_bus} - \text{pt_bus}
</script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Power demand per bus. (batch_size, nbus)</dd>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Power generation per generator. (batch_size, ngen)</dd>
<dt><strong><code>pf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Power flow per branch. (batch_size, nbranch)</dd>
<dt><strong><code>embed_method</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Embedding method to convert component-wise values to bus-wise &ndash; one of "pad", "dense_matrix", or "matrix". Defaults to "pad".</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp to extract only violations. Defaults to True.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Power balance residual. (batch_size, nbus)</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.DCPViolation.calc_violations"><code class="name flex">
<span>def <span class="ident">calc_violations</span></span>(<span>self, pd: torch.Tensor, pg: torch.Tensor, va: torch.Tensor, pf: Optional[torch.Tensor] = None, reduction: str = 'mean', clamp: bool = True, embed_method: str = 'pad') ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="desc"><p>Compute all DCOPF violations.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Power demand per bus. (batch_size, nbus)</dd>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Power generation per generator. (batch_size, ngen)</dd>
<dt><strong><code>va</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage angles per bus. (batch_size, nbus)</dd>
<dt><strong><code>pf</code></strong> :&ensp;<code>Tensor</code>, optional</dt>
<dd>Power flow per branch. Defaults to None.</dd>
<dt><strong><code>reduction</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Reduction method. Defaults to "mean".</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp to extract only violations. Defaults to True.</dd>
<dt><strong><code>embed_method</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Embedding method to convert component-wise values to bus-wise &ndash; one of "pad", "dense_matrix", or "matrix". Defaults to "pad".</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict[str, Tensor]</code></dt>
<dd>Dictionary of all violations:</dd>
</dl>
<ul>
<li>
<p>"pg_lower": Lower bound violation of power generation. (batch_size, ngen)</p>
</li>
<li>
<p>"pg_upper": Upper bound violation of power generation. (batch_size, ngen)</p>
</li>
<li>
<p>"dva_lower": Lower bound violation of voltage angle difference. (batch_size, nbranch)</p>
</li>
<li>
<p>"dva_upper": Upper bound violation of voltage angle difference. (batch_size, nbranch)</p>
</li>
<li>
<p>"pf_lower": Lower bound violation of power flow. (batch_size, nbranch)</p>
</li>
<li>
<p>"pf_upper": Upper bound violation of power flow. (batch_size, nbranch)</p>
</li>
<li>
<p>"p_balance": Power balance violation. (batch_size, nbus)</p>
</li>
<li>
<p>"ohm": Ohm's law violation. (batch_size, nbranch)</p>
</li>
</ul></div>
</dd>
<dt id="ml4opf.formulations.DCPViolation.dva_bound_residual"><code class="name flex">
<span>def <span class="ident">dva_bound_residual</span></span>(<span>self, dva: torch.Tensor, clamp: bool = False) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="desc"><p>Calculate the voltage angle difference bound residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{lower}} = \text{angmin} - \text{dva} </span><script type="math/tex; mode=display"> g_{\text{lower}} = \text{angmin} - \text{dva} </script></span>
<span><span class="MathJax_Preview"> g_{\text{upper}} = \text{dva} - \text{angmax} </span><script type="math/tex; mode=display"> g_{\text{upper}} = \text{dva} - \text{angmax} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>dva</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage angle differences per branch. (batch_size, nbranch)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.DCPViolation.objective"><code class="name flex">
<span>def <span class="ident">objective</span></span>(<span>self, pg: torch.Tensor) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="desc"><p>Compute DCOPF objective function.</p>
<p>Cost is assumed to be constant for the batch, matching the reference case.</p>
<p><span><span class="MathJax_Preview">
\text{objective} = \sum_i^n \text{cost}_{2,i} + \text{cost}_{1,i} \cdot \text{pg}_i
</span><script type="math/tex; mode=display">
\text{objective} = \sum_i^n \text{cost}_{2,i} + \text{cost}_{1,i} \cdot \text{pg}_i
</script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Power generation per generator. (batch_size, ngen)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Objective function value. (batch_size, 1)</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.DCPViolation.ohm_residual"><code class="name flex">
<span>def <span class="ident">ohm_residual</span></span>(<span>self, pf: torch.Tensor, dva: torch.Tensor, clamp: bool = False) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="desc"><p>Compute Ohm's law violation.</p>
<p><span><span class="MathJax_Preview">
\text{g_ohm} = - b \cdot \text{dva} - \text{pf}
</span><script type="math/tex; mode=display">
\text{g_ohm} = - b \cdot \text{dva} - \text{pf}
</script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Power flow per branch. (batch_size, nbranch)</dd>
<dt><strong><code>dva</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage angle differences per branch. (batch_size, nbranch)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp to extract only violations. Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Ohm's law violation. (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.DCPViolation.pf_bound_residual"><code class="name flex">
<span>def <span class="ident">pf_bound_residual</span></span>(<span>self, pf: torch.Tensor, clamp: bool = False) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="desc"><p>Calculate the power flow bound residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{lower}} = -\text{rate_a} - \text{pf} </span><script type="math/tex; mode=display"> g_{\text{lower}} = -\text{rate_a} - \text{pf} </script></span>
<span><span class="MathJax_Preview"> g_{\text{upper}} = \text{pf} - \text{rate_a} </span><script type="math/tex; mode=display"> g_{\text{upper}} = \text{pf} - \text{rate_a} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Power flow per branch. (batch_size, nbranch)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.DCPViolation.pf_from_va"><code class="name flex">
<span>def <span class="ident">pf_from_va</span></span>(<span>self, va: torch.Tensor) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="desc"><p>Compute power flow given voltage angles.</p>
<p><span><span class="MathJax_Preview"> \mathbf{p}_f = -\text{b} \cdot (\boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}) </span><script type="math/tex; mode=display"> \mathbf{p}_f = -\text{b} \cdot (\boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}) </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>va</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage angles per bus ( <span><span class="MathJax_Preview">\boldsymbol{\theta}</span><script type="math/tex">\boldsymbol{\theta}</script></span> ). (batch_size, nbus)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Power flow per branch ( <span><span class="MathJax_Preview">\mathbf{p}_f</span><script type="math/tex">\mathbf{p}_f</script></span> ). (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.DCPViolation.pg_bound_residual"><code class="name flex">
<span>def <span class="ident">pg_bound_residual</span></span>(<span>self, pg: torch.Tensor, clamp: bool = False) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="desc"><p>Calculate the power generation bound residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{lower}} = \text{pmin} - \text{pg} </span><script type="math/tex; mode=display"> g_{\text{lower}} = \text{pmin} - \text{pg} </script></span>
<span><span class="MathJax_Preview"> g_{\text{upper}} = \text{pg} - \text{pmax} </span><script type="math/tex; mode=display"> g_{\text{upper}} = \text{pg} - \text{pmax} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power generation per generator. (batch_size, ngen)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, ngen)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, ngen)</dd>
</dl></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.violation.OPFViolation" href="violation.html#ml4opf.formulations.violation.OPFViolation">OPFViolation</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.violation.OPFViolation.adjacency_matrix" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.adjacency_matrix">adjacency_matrix</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_from_incidence" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_from_incidence">branch_from_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_from_to_bus" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_from_to_bus">branch_from_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_incidence" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_incidence">branch_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_to_incidence" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_to_incidence">branch_to_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_to_to_bus" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_to_to_bus">branch_to_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.forward" href="violation.html#ml4opf.formulations.violation.OPFViolation.forward">forward</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.gen_to_bus" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.gen_to_bus">gen_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.generator_incidence" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.generator_incidence">generator_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.load_incidence" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.load_incidence">load_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.load_to_bus" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.load_to_bus">load_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.violation_shapes" href="violation.html#ml4opf.formulations.violation.OPFViolation.violation_shapes">violation_shapes</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="ml4opf.formulations.OPFModel"><code class="flex name class">
<span>class <span class="ident">OPFModel</span></span>
</code></dt>
<dd>
<div class="desc"><p>An abstract base class for ACOPF models.</p></div>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/0dd79a5b7ba7e1826bd70d110969c0a986455b93/ml4opf/formulations/model.py#L23-L70" class="git-link">Browse git</a></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.acp.model.ACPModel" href="acp/model.html#ml4opf.formulations.acp.model.ACPModel">ACPModel</a></li>
<li><a title="ml4opf.formulations.dcp.model.DCPModel" href="dcp/model.html#ml4opf.formulations.dcp.model.DCPModel">DCPModel</a></li>
<li><a title="ml4opf.formulations.ed.model.EDModel" href="ed/model.html#ml4opf.formulations.ed.model.EDModel">EDModel</a></li>
<li><a title="ml4opf.models.basic_nn.basic_nn.BasicNeuralNet" href="../models/basic_nn/basic_nn.html#ml4opf.models.basic_nn.basic_nn.BasicNeuralNet">BasicNeuralNet</a></li>
</ul>
<h3>Static methods</h3>
<dl>
<dt id="ml4opf.formulations.OPFModel.load_from_checkpoint"><code class="name flex">
<span>def <span class="ident">load_from_checkpoint</span></span>(<span>self, path_to_folder: str, problem: <a title="ml4opf.formulations.problem.OPFProblem" href="problem.html#ml4opf.formulations.problem.OPFProblem">OPFProblem</a>)</span>
</code></dt>
<dd>
<div class="desc"><p>Load the model's checkpoint from a file.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>path</code></strong> :&ensp;<code>str</code></dt>
<dd>Path to load the checkpoint from.</dd>
</dl></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.formulations.OPFModel.evaluate_model"><code class="name flex">
<span>def <span class="ident">evaluate_model</span></span>(<span>self, reduction: Optional[str] = None, inner_reduction: Optional[str] = None) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="desc"><p>Evaluate the model on the test data.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>reduction</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Reduction method for the metrics. Defaults to None. Must be one of "mean", "sum", "none".
If specified, each value in the returned dictionary will be a scalar. Otherwise, they are arrays of shape (n_test_samples,)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict[str, Tensor]</code></dt>
<dd>Dictionary containing Tensor metrics of the model's performance.</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.OPFModel.predict"><code class="name flex">
<span>def <span class="ident">predict</span></span>(<span>self, *inputs: torch.Tensor) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="desc"><p>Predict the solution for a given set of inputs.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>*inputs</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Input tensors to the model.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict[str, Tensor]</code></dt>
<dd>Dictionary containing the solution.</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.OPFModel.save_checkpoint"><code class="name flex">
<span>def <span class="ident">save_checkpoint</span></span>(<span>self, path_to_folder: str)</span>
</code></dt>
<dd>
<div class="desc"><p>Save the model's checkpoint to a file.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>path</code></strong> :&ensp;<code>str</code></dt>
<dd>Path to save the checkpoint.</dd>
</dl></div>
</dd>
</dl>
</dd>
<dt id="ml4opf.formulations.OPFProblem"><code class="flex name class">
<span>class <span class="ident">OPFProblem</span></span>
<span>(</span><span>data_directory: str, case_name: str, dataset_name: str, **parse_kwargs)</span>
</code></dt>
<dd>
<div class="desc"><h1 id="opf-problem">OPF Problem</h1>
<p>This class parses the JSON/HDF5 files on initialization, providing a standard interface for accessing OPF data.</p>
<p>OPFProblem also includes methods for creating input/target tensors from the HDF5 data by concatenating keys,
though more complex datasets (e.g., for graph neural networks) can be created by accessing <code>train_data</code> and <code>json_data</code> directly.</p>
<p>By default, initializing OPFProblem will parse the HDF5/JSON files, remove infeasible samples, and set aside 5000 samples for testing.
The test data can be accessed via <code>test_data</code> - <code>train_data</code> will only contain the training data. Models should split the training data into
training/validation sets themselves downstream.</p>
<p>Attributes:</p>
<ul>
<li>
<p><code>path (Path)</code>: Path to the problem file folder</p>
</li>
<li>
<p><code>name (str)</code>: Name of the problem to use</p>
</li>
<li>
<p><code>train_data (dict)</code>: Dictionary of parsed HDF5 data. If <code>make_test_set</code> is True, this is only the training set.</p>
</li>
<li>
<p><code>test_data (dict)</code>: Dictionary of parsed HDF5 data for the test set. If <code>make_test_set</code> is False, this is None.</p>
</li>
<li>
<p><code>json_data (dict)</code>: Dictionary of parsed JSON data.</p>
</li>
<li>
<p><code><a title="ml4opf.formulations.violation" href="violation.html">ml4opf.formulations.violation</a> (<a title="ml4opf.formulations.OPFViolation" href="#ml4opf.formulations.OPFViolation">OPFViolation</a>)</code>: OPFViolation object for computing constraint violations for this problem.</p>
</li>
</ul>
<p>Methods:</p>
<ul>
<li>
<p><code>parse</code>: Parse the JSON and HDF5 files for the problem</p>
</li>
<li>
<p><code>make_dataset</code>: Create input/target tensors by combining keys from the h5 data. Returns the TensorDataset and slices for extracting the original components.</p>
</li>
<li>
<p><code>slice_batch</code>: Extract the original components from a batch of data given the slices.</p>
</li>
<li>
<p><code>slice_tensor</code>: Extract the original components from a tensor given the slices.</p>
</li>
</ul></div>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/0dd79a5b7ba7e1826bd70d110969c0a986455b93/ml4opf/formulations/problem.py#L27-L252" class="git-link">Browse git</a></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.acp.problem.ACPProblem" href="acp/problem.html#ml4opf.formulations.acp.problem.ACPProblem">ACPProblem</a></li>
<li><a title="ml4opf.formulations.dcp.problem.DCPProblem" href="dcp/problem.html#ml4opf.formulations.dcp.problem.DCPProblem">DCPProblem</a></li>
<li><a title="ml4opf.formulations.ed.problem.EDProblem" href="ed/problem.html#ml4opf.formulations.ed.problem.EDProblem">EDProblem</a></li>
</ul>
<h3>Static methods</h3>
<dl>
<dt id="ml4opf.formulations.OPFProblem.slice_batch"><code class="name flex">
<span>def <span class="ident">slice_batch</span></span>(<span>batch: tuple[torch.Tensor, ...], slices: list[dict[str, slice]])</span>
</code></dt>
<dd>
<div class="desc"><p>Slice the batch tensors into the original tensors</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>batch</code></strong> :&ensp;<code>tuple[Tensor, &hellip;]</code></dt>
<dd>Batch of tensors from the TensorDataset</dd>
<dt><strong><code>slices</code></strong> :&ensp;<code>list[dict[str, slice]]</code></dt>
<dd>List of dictionaries of slices</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>tuple[dict[str, Tensor], &hellip;]</code></dt>
<dd>Sliced tensors</dd>
</dl></div>
</dd>
<dt id="ml4opf.formulations.OPFProblem.slice_tensor"><code class="name flex">
<span>def <span class="ident">slice_tensor</span></span>(<span>tensor: torch.Tensor, slices: dict[str, slice])</span>
</code></dt>
<dd>
<div class="desc"><p>Slice the tensor into the original tensors</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>tensor</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Tensor to slice</dd>
<dt><strong><code>slices</code></strong> :&ensp;<code>dict[str, slice]</code></dt>
<dd>Dictionary of slices</dd>
</dl>
<h2 id="returns">Returns</h2>
<p><code>dict[str, Tensor]</code>: Sliced tensors</p></div>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="ml4opf.formulations.OPFProblem.default_combos"><code class="name">prop <span class="ident">default_combos</span> : dict[str, list[str]]</code></dt>
<dd>
<div class="desc"><p>A dictionary where keys represent elements of the tuple
from the TensorDataset and values are keys of the train_data
dictionary which are concatenated.
Used by <code>make_dataset</code>.</p></div>
</dd>
<dt id="ml4opf.formulations.OPFProblem.default_order"><code class="name">prop <span class="ident">default_order</span> : list[str]</code></dt>
<dd>
<div class="desc"><p>The order of the keys in the default_combos dictionary.</p></div>
</dd>
<dt id="ml4opf.formulations.OPFProblem.default_parse_only"><code class="name">prop <span class="ident">default_parse_only</span> : list[str]</code></dt>
<dd>
<div class="desc"><p>The keys to parse from the HDF5 file.</p>
<p>By default, "meta/<em>", "primal/</em>", and "dual/*" are parsed from the data file
and the entire input file is parsed.</p></div>
</dd>
<dt id="ml4opf.formulations.OPFProblem.feasibility_check"><code class="name">prop <span class="ident">feasibility_check</span> : dict[str, str]</code></dt>
<dd>
<div class="desc"><p>Dictionary of keys and values to check feasibility of the problem.</p>
<p>Each key is checked to have the corresponding value. If any of them
does not match, the sample is removed from the dataset in <code>OPFGeneratorH5Parser</code>.
See ACOPFProblem.feasibility_check for an example.</p></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.formulations.OPFProblem.make_dataset"><code class="name flex">
<span>def <span class="ident">make_dataset</span></span>(<span>self, combos: Optional[dict[str, list[str]]] = None, order: Optional[list[str]] = None, test_set: bool = False, sanity_check: bool = True) ‑> tuple[dict[str, torch.Tensor], list[dict[str, slice]]]</span>
</code></dt>
<dd>
<div class="desc"><p>Make a TensorDataset from self.train_data given the keys in combos and the order of the keys in order.</p></div>
</dd>
<dt id="ml4opf.formulations.OPFProblem.parse"><code class="name flex">
<span>def <span class="ident">parse</span></span>(<span>self, parse_only: Union[str, list[str], ForwardRef(None)] = 'default', train_set_size: Optional[int] = None, feasible_only: Union[bool, dict[str, str]] = True, make_test_set: bool = True, test_set_size: int = 5000, convert_to_float32: bool = True, total_load_range: tuple[typing.Optional[float], typing.Optional[float]] = (None, None), sanity_check: bool = True)</span>
</code></dt>
<dd>
<div class="desc"><p>Parse the JSON and HDF5 files for the problem</p></div>
</dd>
</dl>
</dd>
<dt id="ml4opf.formulations.OPFViolation"><code class="flex name class">
<span>class <span class="ident">OPFViolation</span></span>
<span>(</span><span>json_data: dict[str, typing.Union[bool, int, float, dict[str, torch.Tensor]]])</span>
</code></dt>
<dd>
<div class="desc"><p>The <code><a title="ml4opf.formulations.OPFViolation" href="#ml4opf.formulations.OPFViolation">OPFViolation</a></code> class is where all the problem expressions (objective, constraints, etc.) are defined.
The classes provide a convenient interface for when the only varying quantity in the formulation
per sample is the load demand <code>pd</code>. If other quantities vary, the user should use the functional
interface at <code><a title="ml4opf.functional" href="../functional/index.html">ml4opf.functional</a></code>.</p>
<p>When <code>clamp</code> is true, the values of g(x) are clamped to be non-negative and the values of h(x) are absolute-valued.
Otherwise the raw values are returned.</p>
<p><code><a title="ml4opf.formulations.OPFViolation" href="#ml4opf.formulations.OPFViolation">OPFViolation</a></code> is a <code>torch.nn.Module</code>; all tensors used in computation are registered as non-persistent buffers.
To move the module to a different device, use <code>.to(device)</code> as you would with any other <code>nn.Module</code>.
Make sure that when you pass data to <code><a title="ml4opf.formulations.OPFViolation" href="#ml4opf.formulations.OPFViolation">OPFViolation</a></code>, it is on the same device as <code><a title="ml4opf.formulations.OPFViolation" href="#ml4opf.formulations.OPFViolation">OPFViolation</a></code>.</p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p></div>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/0dd79a5b7ba7e1826bd70d110969c0a986455b93/ml4opf/formulations/violation.py#L22-L114" class="git-link">Browse git</a></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.incidence_mixin.IncidenceMixin" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin">IncidenceMixin</a></li>
<li>torch.nn.modules.module.Module</li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.acp.violation.ACPViolation" href="acp/violation.html#ml4opf.formulations.acp.violation.ACPViolation">ACPViolation</a></li>
<li><a title="ml4opf.formulations.dcp.violation.DCPViolation" href="dcp/violation.html#ml4opf.formulations.dcp.violation.DCPViolation">DCPViolation</a></li>
<li><a title="ml4opf.formulations.ed.violation.EDViolation" href="ed/violation.html#ml4opf.formulations.ed.violation.EDViolation">EDViolation</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="ml4opf.formulations.OPFViolation.SUPPORTED_REDUCTIONS"><code class="name">var <span class="ident">SUPPORTED_REDUCTIONS</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="ml4opf.formulations.OPFViolation.violation_shapes"><code class="name">prop <span class="ident">violation_shapes</span> : dict[str, int]</code></dt>
<dd>
<div class="desc"><p>Return the shapes of the violations returned by <code><a title="ml4opf.formulations.OPFViolation.calc_violations" href="#ml4opf.formulations.OPFViolation.calc_violations">OPFViolation.calc_violations()</a></code>.</p></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.formulations.OPFViolation.calc_violations"><code class="name flex">
<span>def <span class="ident">calc_violations</span></span>(<span>self, *args, reduction: str = 'mean', clamp: bool = True) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="desc"><p>Calculate the violations of the constraints. Returns a dictionary of tensors.</p></div>
</dd>
<dt id="ml4opf.formulations.OPFViolation.forward"><code class="name flex">
<span>def <span class="ident">forward</span></span>(<span>self, *args, **kwargs) ‑> Callable[..., Any]</span>
</code></dt>
<dd>
<div class="desc"><p>Pass-through for <code><a title="ml4opf.formulations.OPFViolation.calc_violations" href="#ml4opf.formulations.OPFViolation.calc_violations">OPFViolation.calc_violations()</a></code></p></div>
</dd>
<dt id="ml4opf.formulations.OPFViolation.objective"><code class="name flex">
<span>def <span class="ident">objective</span></span>(<span>self, *args) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="desc"><p>Compute the objective value for a batch of samples.</p></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.incidence_mixin.IncidenceMixin" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin">IncidenceMixin</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.incidence_mixin.IncidenceMixin.adjacency_matrix" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.adjacency_matrix">adjacency_matrix</a></code></li>
<li><code><a title="ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_from_incidence" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_from_incidence">branch_from_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_from_to_bus" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_from_to_bus">branch_from_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_incidence" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_incidence">branch_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_to_incidence" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_to_incidence">branch_to_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_to_to_bus" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.branch_to_to_bus">branch_to_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.incidence_mixin.IncidenceMixin.gen_to_bus" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.gen_to_bus">gen_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.incidence_mixin.IncidenceMixin.generator_incidence" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.generator_incidence">generator_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.incidence_mixin.IncidenceMixin.load_incidence" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.load_incidence">load_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.incidence_mixin.IncidenceMixin.load_to_bus" href="incidence_mixin.html#ml4opf.formulations.incidence_mixin.IncidenceMixin.load_to_bus">load_to_bus</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul>
<li><a href="#ml4opf-formulations">ML4OPF Formulations</a></li>
</ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="ml4opf" href="../index.html">ml4opf</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="ml4opf.formulations.acp" href="acp/index.html">ml4opf.formulations.acp</a></code></li>
<li><code><a title="ml4opf.formulations.dcp" href="dcp/index.html">ml4opf.formulations.dcp</a></code></li>
<li><code><a title="ml4opf.formulations.ed" href="ed/index.html">ml4opf.formulations.ed</a></code></li>
<li><code><a title="ml4opf.formulations.incidence_mixin" href="incidence_mixin.html">ml4opf.formulations.incidence_mixin</a></code></li>
<li><code><a title="ml4opf.formulations.model" href="model.html">ml4opf.formulations.model</a></code></li>
<li><code><a title="ml4opf.formulations.problem" href="problem.html">ml4opf.formulations.problem</a></code></li>
<li><code><a title="ml4opf.formulations.violation" href="violation.html">ml4opf.formulations.violation</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="ml4opf.formulations.ACPModel" href="#ml4opf.formulations.ACPModel">ACPModel</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.formulations.ACPModel.evaluate_model" href="#ml4opf.formulations.ACPModel.evaluate_model">evaluate_model</a></code></li>
<li><code><a title="ml4opf.formulations.ACPModel.predict" href="#ml4opf.formulations.ACPModel.predict">predict</a></code></li>
<li><code><a title="ml4opf.formulations.ACPModel.problem" href="#ml4opf.formulations.ACPModel.problem">problem</a></code></li>
<li><code><a title="ml4opf.formulations.ACPModel.violation" href="#ml4opf.formulations.ACPModel.violation">violation</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.formulations.ACPProblem" href="#ml4opf.formulations.ACPProblem">ACPProblem</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.formulations.ACPProblem.default_combos" href="#ml4opf.formulations.ACPProblem.default_combos">default_combos</a></code></li>
<li><code><a title="ml4opf.formulations.ACPProblem.default_order" href="#ml4opf.formulations.ACPProblem.default_order">default_order</a></code></li>
<li><code><a title="ml4opf.formulations.ACPProblem.feasibility_check" href="#ml4opf.formulations.ACPProblem.feasibility_check">feasibility_check</a></code></li>
<li><code><a title="ml4opf.formulations.ACPProblem.violation" href="#ml4opf.formulations.ACPProblem.violation">violation</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.formulations.ACPViolation" href="#ml4opf.formulations.ACPViolation">ACPViolation</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.formulations.ACPViolation.angle_difference" href="#ml4opf.formulations.ACPViolation.angle_difference">angle_difference</a></code></li>
<li><code><a title="ml4opf.formulations.ACPViolation.balance_residual" href="#ml4opf.formulations.ACPViolation.balance_residual">balance_residual</a></code></li>
<li><code><a title="ml4opf.formulations.ACPViolation.calc_violations" href="#ml4opf.formulations.ACPViolation.calc_violations">calc_violations</a></code></li>
<li><code><a title="ml4opf.formulations.ACPViolation.dva_bound_residual" href="#ml4opf.formulations.ACPViolation.dva_bound_residual">dva_bound_residual</a></code></li>
<li><code><a title="ml4opf.formulations.ACPViolation.flows_from_voltage" href="#ml4opf.formulations.ACPViolation.flows_from_voltage">flows_from_voltage</a></code></li>
<li><code><a title="ml4opf.formulations.ACPViolation.flows_from_voltage_bus" href="#ml4opf.formulations.ACPViolation.flows_from_voltage_bus">flows_from_voltage_bus</a></code></li>
<li><code><a title="ml4opf.formulations.ACPViolation.objective" href="#ml4opf.formulations.ACPViolation.objective">objective</a></code></li>
<li><code><a title="ml4opf.formulations.ACPViolation.pg_bound_residual" href="#ml4opf.formulations.ACPViolation.pg_bound_residual">pg_bound_residual</a></code></li>
<li><code><a title="ml4opf.formulations.ACPViolation.qg_bound_residual" href="#ml4opf.formulations.ACPViolation.qg_bound_residual">qg_bound_residual</a></code></li>
<li><code><a title="ml4opf.formulations.ACPViolation.thermal_residual" href="#ml4opf.formulations.ACPViolation.thermal_residual">thermal_residual</a></code></li>
<li><code><a title="ml4opf.formulations.ACPViolation.vm_bound_residual" href="#ml4opf.formulations.ACPViolation.vm_bound_residual">vm_bound_residual</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.formulations.DCPModel" href="#ml4opf.formulations.DCPModel">DCPModel</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.formulations.DCPModel.evaluate_model" href="#ml4opf.formulations.DCPModel.evaluate_model">evaluate_model</a></code></li>
<li><code><a title="ml4opf.formulations.DCPModel.predict" href="#ml4opf.formulations.DCPModel.predict">predict</a></code></li>
<li><code><a title="ml4opf.formulations.DCPModel.problem" href="#ml4opf.formulations.DCPModel.problem">problem</a></code></li>
<li><code><a title="ml4opf.formulations.DCPModel.violation" href="#ml4opf.formulations.DCPModel.violation">violation</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.formulations.DCPProblem" href="#ml4opf.formulations.DCPProblem">DCPProblem</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.formulations.DCPProblem.default_combos" href="#ml4opf.formulations.DCPProblem.default_combos">default_combos</a></code></li>
<li><code><a title="ml4opf.formulations.DCPProblem.default_order" href="#ml4opf.formulations.DCPProblem.default_order">default_order</a></code></li>
<li><code><a title="ml4opf.formulations.DCPProblem.feasibility_check" href="#ml4opf.formulations.DCPProblem.feasibility_check">feasibility_check</a></code></li>
<li><code><a title="ml4opf.formulations.DCPProblem.violation" href="#ml4opf.formulations.DCPProblem.violation">violation</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.formulations.DCPViolation" href="#ml4opf.formulations.DCPViolation">DCPViolation</a></code></h4>
<ul class="two-column">
<li><code><a title="ml4opf.formulations.DCPViolation.angle_difference" href="#ml4opf.formulations.DCPViolation.angle_difference">angle_difference</a></code></li>
<li><code><a title="ml4opf.formulations.DCPViolation.balance_residual" href="#ml4opf.formulations.DCPViolation.balance_residual">balance_residual</a></code></li>
<li><code><a title="ml4opf.formulations.DCPViolation.calc_violations" href="#ml4opf.formulations.DCPViolation.calc_violations">calc_violations</a></code></li>
<li><code><a title="ml4opf.formulations.DCPViolation.dva_bound_residual" href="#ml4opf.formulations.DCPViolation.dva_bound_residual">dva_bound_residual</a></code></li>
<li><code><a title="ml4opf.formulations.DCPViolation.nrate_a" href="#ml4opf.formulations.DCPViolation.nrate_a">nrate_a</a></code></li>
<li><code><a title="ml4opf.formulations.DCPViolation.objective" href="#ml4opf.formulations.DCPViolation.objective">objective</a></code></li>
<li><code><a title="ml4opf.formulations.DCPViolation.ohm_residual" href="#ml4opf.formulations.DCPViolation.ohm_residual">ohm_residual</a></code></li>
<li><code><a title="ml4opf.formulations.DCPViolation.pf_bound_residual" href="#ml4opf.formulations.DCPViolation.pf_bound_residual">pf_bound_residual</a></code></li>
<li><code><a title="ml4opf.formulations.DCPViolation.pf_from_va" href="#ml4opf.formulations.DCPViolation.pf_from_va">pf_from_va</a></code></li>
<li><code><a title="ml4opf.formulations.DCPViolation.pg_bound_residual" href="#ml4opf.formulations.DCPViolation.pg_bound_residual">pg_bound_residual</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.formulations.OPFModel" href="#ml4opf.formulations.OPFModel">OPFModel</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.formulations.OPFModel.evaluate_model" href="#ml4opf.formulations.OPFModel.evaluate_model">evaluate_model</a></code></li>
<li><code><a title="ml4opf.formulations.OPFModel.load_from_checkpoint" href="#ml4opf.formulations.OPFModel.load_from_checkpoint">load_from_checkpoint</a></code></li>
<li><code><a title="ml4opf.formulations.OPFModel.predict" href="#ml4opf.formulations.OPFModel.predict">predict</a></code></li>
<li><code><a title="ml4opf.formulations.OPFModel.save_checkpoint" href="#ml4opf.formulations.OPFModel.save_checkpoint">save_checkpoint</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.formulations.OPFProblem" href="#ml4opf.formulations.OPFProblem">OPFProblem</a></code></h4>
<ul class="two-column">
<li><code><a title="ml4opf.formulations.OPFProblem.default_combos" href="#ml4opf.formulations.OPFProblem.default_combos">default_combos</a></code></li>
<li><code><a title="ml4opf.formulations.OPFProblem.default_order" href="#ml4opf.formulations.OPFProblem.default_order">default_order</a></code></li>
<li><code><a title="ml4opf.formulations.OPFProblem.default_parse_only" href="#ml4opf.formulations.OPFProblem.default_parse_only">default_parse_only</a></code></li>
<li><code><a title="ml4opf.formulations.OPFProblem.feasibility_check" href="#ml4opf.formulations.OPFProblem.feasibility_check">feasibility_check</a></code></li>
<li><code><a title="ml4opf.formulations.OPFProblem.make_dataset" href="#ml4opf.formulations.OPFProblem.make_dataset">make_dataset</a></code></li>
<li><code><a title="ml4opf.formulations.OPFProblem.parse" href="#ml4opf.formulations.OPFProblem.parse">parse</a></code></li>
<li><code><a title="ml4opf.formulations.OPFProblem.slice_batch" href="#ml4opf.formulations.OPFProblem.slice_batch">slice_batch</a></code></li>
<li><code><a title="ml4opf.formulations.OPFProblem.slice_tensor" href="#ml4opf.formulations.OPFProblem.slice_tensor">slice_tensor</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.formulations.OPFViolation" href="#ml4opf.formulations.OPFViolation">OPFViolation</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.formulations.OPFViolation.SUPPORTED_REDUCTIONS" href="#ml4opf.formulations.OPFViolation.SUPPORTED_REDUCTIONS">SUPPORTED_REDUCTIONS</a></code></li>
<li><code><a title="ml4opf.formulations.OPFViolation.calc_violations" href="#ml4opf.formulations.OPFViolation.calc_violations">calc_violations</a></code></li>
<li><code><a title="ml4opf.formulations.OPFViolation.forward" href="#ml4opf.formulations.OPFViolation.forward">forward</a></code></li>
<li><code><a title="ml4opf.formulations.OPFViolation.objective" href="#ml4opf.formulations.OPFViolation.objective">objective</a></code></li>
<li><code><a title="ml4opf.formulations.OPFViolation.violation_shapes" href="#ml4opf.formulations.OPFViolation.violation_shapes">violation_shapes</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.1</a>.</p>
</footer>
</body>
</html>
